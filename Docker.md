# Docker

Lorem Ipsum es simplemente el texto de relleno de las imprentas y archivos de texto. Lorem Ipsum ha sido el texto de relleno estándar de las industrias desde el año 1500, cuando un impresor (N. del T. persona que se dedica a la imprenta) desconocido usó una galería de textos y los mezcló de tal manera que logró hacer un libro de textos especimen. No sólo sobrevivió 500 años, sino que tambien ingresó como texto de relleno en documentos electrónicos, quedando esencialmente igual al original. Fue popularizado en los 60s con la creación de las hojas "Letraset", las cuales contenian pasajes de Lorem Ipsum, y más recientemente con software de autoedición, como por ejemplo Aldus PageMaker, el cual incluye versiones de Lorem Ipsum.
Lorem Ipsum es simplemente el texto de relleno de las imprentas y archivos de texto. Lorem Ipsum ha sido el texto de relleno estándar de las industrias desde el año 1500, cuando un impresor (N. del T. persona que se dedica a la imprenta) desconocido usó una galería de textos y los mezcló de tal manera que logró hacer un libro de textos especimen. No sólo sobrevivió 500 años, sino que tambien ingresó como texto de relleno en documentos electrónicos, quedando esencialmente igual al original. Fue popularizado en los 60s con la creación de las hojas "Letraset", las cuales contenian pasajes de Lorem Ipsum, y más recientemente con software de autoediciónh, como por ejemplo Aldus PageMaker, el cual incluye versiones de Lorem Ipsum.


Lorem Ipsum es simplemente el texto de relleno de las imprentas y archivos de texto. Lorem Ipsum ha sido el texto de relleno estándar de las industrias desde el año 1500, cuando un impresor (N. del T. persona que se dedica a la imprenta) desconocido usó una galería de textos y los mezcló de tal manera que logró hacer un libro de textos especimen. No sólo sobrevivió 500 años, sino que tambien ingresó como texto de relleno en documentos electrónicos, quedando esencialmente igual al original. Fue popularizado en los 60s con la creación de las hojas "Letraset", las cuales contenian pasajes de Lorem Ipsum, y más recientemente con software de autoedición, como por ejemplo Aldus PageMaker, el cual incluye versiones de Lorem Ipsum.

Lorem Ipsum es simplemente el texto de relleno de las imprentas y archivos de texto. Lorem Ipsum ha sido el texto de relleno estándar de las industrias desde el año 1500, cuando un impresor (N. del T. persona que se dedica a la imprenta) desconocido usó una galería de textos y los mezcló de tal manera que logró hacer un libro de textos especimen. No sólo sobrevivió 500 años, sino que tambien ingresó como texto de relleno en documentos electrónicos, quedando esencialmente igual al original. Fue popularizado en los 60s con la creación de las hojas "Letraset", las cuales contenian pasajes de Lorem Ipsum, y más recientemente con software de autoedición, como por ejemplo Aldus PageMaker, el cual incluye versiones de Lorem Ipsum.

<h1  id="text">prueba</h1> 

Lorem Ipsum es simplemente el texto de relleno de las imprentas y archivos de texto. Lorem Ipsum ha sido el texto de relleno estándar de las industrias desde el año 1500, cuando un impresor (N. del T. persona que se dedica a la imprenta) desconocido usó una galería de textos y los mezcló de tal manera que logró hacer un libro de textos especimen. No sólo sobrevivió 500 años, sino que tambien ingresó como texto de relleno en documentos electrónicos, quedando esencialmente igual al original. Fue popularizado en los 60s con la creación de las hojas "Letraset", las cuales contenian pasajes de Lorem Ipsum, y más recientemente con software de autoedición, como por ejemplo Aldus PageMaker, el cual incluye versiones de Lorem Ipsum.


<h1  id="contenido">como se compone</h1>
Docker es de codigo abierto facilita el proceso de creación y diseño de contenedores el envío de imágenes y creación de versiones de imagen de los contenedores se usan como máquinas virtuales pero a diferencia de las máquinas virtuales suelen utilizarse para levantar máquinas independientes. con sistemas operativos muy ligeros lo 
que permite crear implementar copiar y mover los contenedores de un entorno a otro dado que los contenedores requieren mucho menos recursos se inician rápidamente y son fáciles de implementar con mayor densidad.
lo que significa que se puede ejecutar más servicios en la misma unidad de hardware reduciendo así los costos lo que es un punto para contenedores y trabaja con imágenes que son plantillas de sólo lectura, que definen su contenedor la imagen contiene el código que se ejecutará incluido
cualquier definición para cualquier biblioteca o dependencia que el código necesite realmente un contenedor de docker es una imagen de docker instancia da o en ejecución o que permite entregar código con mayor rapidez estandarizar las operaciones de las aplicaciones y transferir el código con facilidad lo que tiene una sintaxis sencilla y simple que aporta un control absoluto a todo la tecnología docker usa el kernel de linux y las funciones de éste pueden ejecutarse de manera independiente ofrecen un modelo de implementación basado en imágenes automatiza la implementación de las aplicaciones o conjuntos combinados de procesos que
constituyen una aplicación en un entorno de contenedores algunas de las características principales son portabilidad ligereza autosuficiencia y entre sus ventajas se pueden sonar las higueras se tienen consistencia de versiones reduce el tiempo las actualizaciones y despliegue de las aplicaciones ocupa menos espacio en disco de igual forma se pueden mencionar la curva de aprendizaje que puede ser algo complicado y exigente en un principio y si quieres empezar con


### ㅤㅤ
### ㅤㅤ
<!-- Inicia la investigacion de docker con AWS-->

## **La ejecución de Docker en AWS**

La ejecución de Docker en AWS les ofrece a desarrolladores y administradores una manera muy confiable y económica de crear, enviar y ejecutar aplicaciones distribuidas en cualquier escala.

Docker colabora con AWS para ayudar a los desarrolladores a acelerar la entrega de aplicaciones modernas a la nube. Esta colaboración ayuda a los desarrolladores a utilizar Docker Compose y Docker Desktop para aprovechar el mismo flujo de trabajo local que utilizan hoy a fin de implementar sin inconvenientes aplicaciones en Amazon ECS y en AWS Fargate.
### ㅤㅤ

## **Ejecute Docker en AWS**

AWS proporciona soporte técnico para Docker de código abierto y para sus soluciones comerciales. Existen varias maneras de ejecutar contenedores en AWS, incluido Amazon Elastic Container Service (ECS), un servicio de administración de contenedores altamente escalable y de gran desempeño. Los clientes pueden implementar de manera fácil sus aplicaciones en contenedores del entorno Docker local directamente a Amazon ECS. AWS Fargate es una tecnología para Amazon ECS que permite ejecutar contenedores en producción sin implementar o administrar infraestructura. Amazon Elastic Container Service for Kubernetes (EKS) facilita la ejecución de Kubernetes en AWS. AWS Fargate es una tecnología para Amazon ECS que le permite ejecutar contenedores sin aprovisionar ni administrar servidores. Amazon Elastic Container Registry (ECR) es un repositorio de contenedores privado seguro y altamente disponible que facilita el almacenamiento y la administración de imágenes de contenedores de Docker, así como el cifrado y la compresión de imágenes en reposo de manera que se puedan extraer de manera rápida y segura. AWS Batch le permite ejecutar cargas de trabajo de procesamiento por lotes altamente escalables con contenedores de Docker.


<div align="center" style="vertical-align:center" >
<div align="" style="vertical-align:center">
<a href="https://aws.amazon.com/es/ecs/"><img width="255" align="vertical-align:middle" src="src/img/servicio6.png" alt="Docker"></a> ㅤ ㅤ ㅤ ㅤ ㅤ ㅤ
<a href="https://aws.amazon.com/es/fargate/"><img width="270" align="vertical-align:middle" src="src/img/servicio5.png" alt="Kubernetes"></a></div>
</div>

### ㅤㅤ

<div align="center" style="vertical-align:center" >
<div align="" style="vertical-align:center">
<a href="https://aws.amazon.com/es/eks/"><img width="280" align="vertical-align:middle" src="src/img/servicio4.png"></a> ㅤ ㅤ ㅤ ㅤ ㅤ ㅤ
<a href="https://aws.amazon.com/es/ecr/"><img width="270" align="vertical-align:middle" src="src/img/servicio3.png"></a></div>
</div>

### ㅤㅤ

<div align="center" style="vertical-align:center" >
<div align="" style="vertical-align:center">
<a href="https://aws.amazon.com/es/batch/"><img width="276" align="vertical-align:middle" src="src/img/servicio2.png"></a> ㅤ ㅤ ㅤ ㅤ ㅤ ㅤ
<a href="https://aws.amazon.com/es/containers/copilot/"><img width="270" align="vertical-align:middle" src="src/img/servicio1.png"></a></div>
</div>

### ㅤㅤ

## **Como usarlo en AWS**

Los pasos que aparecen a continuación le ayudarán a comenzar a usar Docker en AWS  en cuestión de minutos.
<!-- inscripcion aws -->
<div align="center">
<a href="https://aws.amazon.com/es/batch/"><img width="200" align="vertical-align:middle" src="https://d1.awsstatic.com/Digital%20Marketing/icon1.e8803ca4304aca252ee0aa510c3908cb69fab31b.png"></a></div>

##### <p align = "center">Inscribirse en una cuenta de AWS</p>
[<p align = "center">Obtenga acceso instantáneo a la capa gratuita de AWS.</p>](https://aws.amazon.com/es/free/)

<!-- implementando contenedores docker en aws -->
<div align="center">
<a href="https://aws.amazon.com/es/batch/"><img width="180" align="vertical-align:middle" src="https://d1.awsstatic.com/Digital%20Marketing/icon2.623e85d1e491004eb9ec929e9ebe4631b75d61e5.png"></a></div>

##### <p align = "center">Implemente contenedores de Docker en 10 minutos</p>
[<p align = "center">Utilizar Docker Desktop: implemente contenedores de Docker en Amazon ECS en este simple tutorial con la CLI de Docker.</p>](https://aws.amazon.com/blogs/containers/deploy-applications-on-amazon-ecs-using-docker-compose/)

## Implemente aplicaciones en Amazon ECS mediante Docker Compose

Docker Compose es una forma elegante pero muy simple de describir su pila de aplicaciones en contenedores. Este formato ha sido utilizado y seguirá siendo utilizado por miles de desarrolladores para ejecutar aplicaciones que requieren múltiples contenedores Docker y comunicación de servicio a servicio. A menudo, estos desarrolladores también buscan una forma conveniente de ejecutar su código en AWS.

Con este espíritu en mente, AWS y Docker, comenzaron a colaborar en las especificaciones abiertas de Docker Compose para crear una ruta para que los desarrolladores utilicen el formato Docker Compose para implementar sus aplicaciones en Amazon ECS y AWS Fargate . En julio, Docker lanzó una versión beta para Docker Desktop que incorporaba estas funcionalidades y, el 15 de septiembre, Docker lanzó una experiencia actualizada en su canal estable de Docker Desktop .

Con todo este trasfondo fuera del camino, ensuciémonos las manos. El resto de este blog está estructurado en torno a dos temas principales:

- Uso de Docker Compose para ampliar las inversiones existentes
- Uso de Docker Compose para mejorar la experiencia del desarrollador de ECS

## Uso de Docker Compose para ampliar las inversiones existentes

Hace cuatro años, creé una aplicación simple (pero representativa de la vida real) que podía usar como base para aprender nuevas tecnologías. En lugar de centrarme en una tecnología en abstracto y probar el tutorial que venía con ella, quería centrarme en "mi aplicación" e intentar usar la tecnología en mi contexto definido y existente. Al final del día, esto es lo que hacen los clientes reales. Su objetivo no es ejecutar el ejemplo con éxito, sino aplicar la tecnología que están evaluando a su propia pila de aplicaciones. Simplemente quería imitar los patrones de adopción de tecnologías del cliente.

Entra Yelb . Yelb es una aplicación web tradicional con cuatro componentes: una interfaz de usuario, un servidor de aplicaciones, un servidor de caché y una base de datos.

<div align="center">
<img width="700" align="vertical-align:middle" src="https://d2908q01vomqb2.cloudfront.net/fe2ef495a1152561572949784c16bf23abb28057/2020/11/18/image-76.png"></div>

A medida que comencé a aprender diferentes soluciones basadas en contenedores a lo largo de los años, las apliqué a Yelb. Hoy puede implementar una versión en contenedor de Yelb con Docker Compose, Kubernetes y ECS . Esto me obligó a crear toda la coreografía YAML para cada uno de los orquestadores (en el orden específico que mencioné) mientras usaba las mismas imágenes de contenedor.

Desde que comenzamos esta colaboración con Docker, continué preguntándome: “¿Qué pasa si no quiero o no puedo dedicar tiempo a volver a crear el archivo YAML original de Docker Compose en un archivo ECS YAML nativo ? ¿Funcionaría esta integración de Docker Compose/ECS para Yelb?” Mi archivo Yelb Docker Compose es uno entre los 650.000 que mencioné anteriormente.

Curiosamente, mi prueba funcionó de inmediato con el archivo Docker Compose que creé hace más de 4 años .

Déjame mostrarte cómo es la experiencia del desarrollador. Más adelante, tocaremos la mecánica de cómo funciona esto detrás de escena. Por ahora lo único que necesitas es Docker Desktop y una cuenta de AWS . Para esta prueba, estoy usando Docker Desktop (estable) versión 2.5.0.1.

Lo primero que debe hacer es clonar el repositorio de Yelb y pasar al directorio de implementación que incluye el archivo Compose YAML en el repositorio ( docker-compose.yaml):

~~~
➜ git clone https://github.com/mreferre/yelb 
Cloning into 'yelb'...
remote: Enumerating objects: 4, done.
remote: Counting objects: 100% (4/4), done.
remote: Compressing objects: 100% (4/4), done.
remote: Total 805 (delta 0), reused 0 (delta 0), pack-reused 801
Receiving objects: 100% (805/805), 3.41 MiB | 1.25 MiB/s, done.
Resolving deltas: 100% (416/416), done.

➜ cd ./yelb/deployments/platformdeployment/Docker/

➜ ls
README.md docker-compose.yaml stack-deploy.yaml
~~~

Ahora podemos docker-compose upel archivo Compose YAML en el repositorio. Esto, por defecto, creará una instancia de la aplicación Yelb en su estación de trabajo:

~~~
➜ docker-compose up -d
Creating network "docker_yelb-network" with driver "bridge"
Creating docker_yelb-db_1 ... done
Creating docker_redis-server_1 ... done
Creating docker_yelb-appserver_1 ... done
Creating docker_yelb-ui_1 ... done
~~~

Puede probar que todo funciona apuntando su navegador web a la http://localhostde su máquina. Debería ver la aplicación de votación de Yelb:

<div align="center">
<img width="700" align="vertical-align:middle" src="https://d2908q01vomqb2.cloudfront.net/fe2ef495a1152561572949784c16bf23abb28057/2020/11/18/image-77.png"></div>

Si la prueba fue exitosa, ahora puede romper su pila local ejecutando docker-compose down. Si proviene de Docker, probablemente haya utilizado este flujo de trabajo miles de veces durante varios años. Nada nuevo aquí.

Como solemos decir, una imagen vale más que 1000 palabras. Esta es una representación visual del flujo que acabamos de ejecutar (observe que aún no se implementa nada en la nube de AWS):

<div align="center">
<img width="700" align="vertical-align:middle" src="https://d2908q01vomqb2.cloudfront.net/fe2ef495a1152561572949784c16bf23abb28057/2020/11/18/image-78.png"></div>

Veamos ahora cómo podemos implementar la misma pila en ECS. Para hacer esto, debemos preparar nuestro entorno Docker Desktop .

Primero, crearemos un nuevo contexto de ventana acoplable para que la CLI de Docker pueda apuntar a un punto final diferente. De forma predeterminada, Docker apunta a un contexto local llamado default(que es el tiempo de ejecución de Docker en su máquina), pero agregaremos un contexto de Amazon ECS con el comando docker context create ecs.

Una nota sobre las credenciales de AWS: si ya está familiarizado con AWS, probablemente ya tenga listo su entorno AWS CLI con un perfil predeterminado o con nombre. Está bien, la CLI de Docker puede usar esas credenciales. De lo contrario, el flujo de trabajo de Docker le permitirá leer las variables de entorno con sus credenciales de AWS ( AWS_ACCESS_KEY_IDy AWS_SECRET_ACCESS_KEY) o le pedirá esas credenciales y las almacenará por usted (en $HOME/.aws/credentials).

En este ejemplo, apunto el flujo de trabajo de Docker a mi perfil de AWS existente:

~~~
➜ docker context create ecs myecscontext
? Create a Docker context using: An existing AWS profile
? Select AWS Profile default
Successfully created ecs context "myecscontext"  
~~~

Ahora, Docker tiene una llamada de contexto adicional myecscontext(o tipo ecs) que apunta a mi perfil predeterminado de AWS CLI existente. Tenga en cuenta que también estamos configurando myecscontextpara que sea nuestro nuevo contexto activo (que está marcado con un *):

~~~
➜ docker context ls                     
NAME                TYPE                DESCRIPTION                               DOCKER ENDPOINT               KUBERNETES ENDPOINT   ORCHESTRATOR
default *           moby                Current DOCKER_HOST based configuration   unix:///var/run/docker.sock                         swarm
myecscontext        ecs                                                                                                               
➜ docker context use myecscontext
myecscontext
➜ docker context ls              
NAME                TYPE                DESCRIPTION                               DOCKER ENDPOINT               KUBERNETES ENDPOINT   ORCHESTRATOR
default             moby                Current DOCKER_HOST based configuration   unix:///var/run/docker.sock                         swarm
~~~

Las credenciales en el perfil de AWS deben tener suficientes permisos para implementar la aplicación en AWS. Esto incluye permisos para crear, por ejemplo, VPC, tareas de ECS, balanceadores de carga, etc.

Ahora vamos a poner la pila de Yelb en vivo en la nube.

Tenga en cuenta cómo ahora estoy usando el binario principal de la ventana acoplable para hacer esto, en lugar del docker-composebinario que he usado anteriormente para implementar localmente. El dockerbinario ahora viene con una funcionalidad ampliada para docker compose up(más sobre esto más adelante).

~~~
➜ docker compose up 
WARN[0001] networks.driver: unsupported attribute       
[+] Running 26/26
 ⠿ docker                              CreateComplete                                                                                                        345.5s
 ⠿ YelbuiTCP80TargetGroup              CreateComplete                                                                                                          0.0s
 ⠿ LogGroup                            CreateComplete                                                                                                          2.2s
 ⠿ YelbuiTaskExecutionRole             CreateComplete                                                                                                         14.0s
 ⠿ YelbnetworkNetwork                  CreateComplete                                                                                                          5.0s
 ⠿ YelbdbTaskExecutionRole             CreateComplete                                                                                                         14.0s
 ⠿ CloudMap                            CreateComplete                                                                                                         48.3s
 ⠿ Cluster                             CreateComplete                                                                                                          6.0s
 ⠿ YelbappserverTaskExecutionRole      CreateComplete                                                                                                         14.0s
 ⠿ RedisserverTaskExecutionRole        CreateComplete                                                                                                         13.0s
 ⠿ YelbnetworkNetworkIngress           CreateComplete                                                                                                          0.0s
 ⠿ Yelbnetwork80Ingress                CreateComplete                                                                                                          1.0s
 ⠿ LoadBalancer                        CreateComplete                                                                                                        122.5s
 ⠿ RedisserverTaskDefinition           CreateComplete                                                                                                          4.0s
 ⠿ YelbappserverTaskDefinition         CreateComplete                                                                                                          3.0s
 ⠿ YelbuiTaskDefinition                CreateComplete                                                                                                          3.0s
 ⠿ YelbdbTaskDefinition                CreateComplete                                                                                                          3.0s
 ⠿ RedisserverServiceDiscoveryEntry    CreateComplete                                                                                                          1.1s
 ⠿ YelbdbServiceDiscoveryEntry         CreateComplete                                                                                                          5.5s
 ⠿ YelbuiServiceDiscoveryEntry         CreateComplete                                                                                                          4.4s
 ⠿ YelbappserverServiceDiscoveryEntry  CreateComplete                                                                                                          4.4s
 ⠿ RedisserverService                  CreateComplete                                                                                                         68.2s
 ⠿ YelbdbService                       CreateComplete                                                                                                         77.7s
 ⠿ YelbuiTCP80Listener                 CreateComplete                                                                                                          5.4s
 ⠿ YelbappserverService                CreateComplete                                                                                                        108.5s
 ⠿ YelbuiService                       CreateComplete                                                                                                         76.6s 
➜ docker compose ps 
ID                                         NAME                REPLICAS            PORTS
docker-RedisserverService-bs6RqrSUuIux     redis-server        1/1                 
docker-YelbappserverService-yG2xExxLjU6D   yelb-appserver      1/1                 
docker-YelbdbService-RDGo1mRenFMt          yelb-db             1/1                 
docker-YelbuiService-X0bPBdwZmNcC          yelb-ui             1/1 
~~~

Si observa los detalles de esta pila de redacción ( docker compose ps), verá que el yelb-uicomponente está expuesto en un puerto particular de un punto final particular. En el ejemplo anterior, cuando apunto mi navegador https://docke-LoadB-C7CWCW0SZZCC-240648981.us-east-1.elb.amazonaws.com:80veo la misma aplicación (descrita en el mismo archivo de Docker Compose) implementada en ECS y Fargate.

Esta es una representación visual del flujo que hemos utilizado:

<div align="center">
<img width="700" align="vertical-align:middle" src="https://d2908q01vomqb2.cloudfront.net/fe2ef495a1152561572949784c16bf23abb28057/2020/11/18/image-79.png"></div>

Esto es lo que sucedió tras bambalinas:

- Tú docker compose upy Docker leen eldocker-compose.yaml
- Docker convierte el archivo de composición original sobre la marcha en una plantilla de AWS CloudFormation
- Docker implementa la plantilla de CloudFormation en AWS
